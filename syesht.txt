<?php
$sitemap_name = 'web';
$list_file = 'bray.txt';
$max_links_per_sitemap = 10000;

$domain = 'https://e-learn.poltekapp.ac.id';

$keywords = file($list_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);

$sitemap_index = '<?xml version="1.0" encoding="UTF-8"?>' . PHP_EOL;
$sitemap_index .= '<sitemapindex xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">' . PHP_EOL;

$sitemap_files = [];

foreach ($keywords as $i => $line) {
    $line = trim($line);
    if ($line === '') continue;

    $slug = urlencode($line);

    $url = $domain . '/' . $slug;

    $sitemap_file_number = ceil(($i + 1) / $max_links_per_sitemap);

    if (!isset($sitemap_files[$sitemap_file_number])) {
        $sitemap_files[$sitemap_file_number] = '<?xml version="1.0" encoding="UTF-8"?>' . PHP_EOL;
        $sitemap_files[$sitemap_file_number] .= '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">' . PHP_EOL;
    }

    $sitemap_files[$sitemap_file_number] .= "  <url>\n";
    $sitemap_files[$sitemap_file_number] .= "    <loc>$url</loc>\n";
    $sitemap_files[$sitemap_file_number] .= "  </url>\n";
}

foreach ($sitemap_files as $number => $content) {
    $content .= "</urlset>\n";
    file_put_contents("$sitemap_name-$number.xml", $content);

    $sitemap_index .= "  <sitemap>\n";
    $sitemap_index .= "    <loc>$domain/$sitemap_name-$number.xml</loc>\n";
    $sitemap_index .= "  </sitemap>\n";
}

$sitemap_index .= "</sitemapindex>\n";
file_put_contents("$sitemap_name.xml", $sitemap_index);

echo "DONE YA GANTENG ^^";
?>
